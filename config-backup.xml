<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>#{RUNTIME_BASE_URL}</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <email-provider>smtp</email-provider>
            <symmetric-key>data:text/plain;aes,v:S.aHZuSG9IZGg1V09tT05oag==.RuEP4Z-JI2zfE-mFMl3RWA==.LptBEaz-Dma9emzzaWJn4aps9I_ceNssn4eaB7eqQ-gVk-YpUV_KNl9jeCQLKNK5TWIn0_QW5syHdXn_qb9r-x1LZ4QPvivD32xRzBSMrj4=.52dumlLW88wTntFWqBJO4XdnFBFRnf_8cUjNCFyNHuk=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authentication-actions>
            <authentication-action>
              <id>country-load</id>
              <data-source-transformer xmlns="https://curity.se/ns/ext-conf/data-source-transformer">
                <attribute-data-source>
                  <data-source>default-datasource</data-source>
                </attribute-data-source>
                <additional-attributes-to-include>countrycode</additional-attributes-to-include>
                <attributes-location>action-attributes</attributes-location>
              </data-source-transformer>
            </authentication-action>
            <authentication-action>
              <id>country-prompt</id>
              <attribute-prompt xmlns="https://curity.se/ns/ext-conf/attribute-prompt">
                <required-attribute>
                  <name>countrycode</name>
                  <attribute-source>action-attributes</attribute-source>
                  <type>text</type>
                </required-attribute>
              </attribute-prompt>
            </authentication-action>
            <authentication-action>
              <id>country-script</id>
              <script-transformer xmlns="https://curity.se/ns/ext-conf/script-transformer">
                <attributes-location>action-attributes</attributes-location>
                <transformation-procedure>country-proc</transformation-procedure>
              </script-transformer>
            </authentication-action>
            <authentication-action>
              <id>country-sequence</id>
              <sequence xmlns="https://curity.se/ns/ext-conf/sequence">
                <action>country-load</action>
                <action>country-prompt</action>
                <action>country-update</action>
              </sequence>
            </authentication-action>
            <authentication-action>
              <id>country-update</id>
              <update-account xmlns="https://curity.se/ns/ext-conf/update-account">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
                <operation>
                  <name>save-country</name>
                  <add-attribute>
                    <source-attribute-is-required>false</source-attribute-is-required>
                    <source-attribute-location>action-attributes</source-attribute-location>
                    <source-attribute-path>countrycode</source-attribute-path>
                    <target-attribute-path>countrycode</target-attribute-path>
                  </add-attribute>
                </operation>
              </update-account>
            </authentication-action>
            <authentication-action>
              <id>debug</id>
              <debug-attribute xmlns="https://curity.se/ns/ext-conf/debug-attribute"/>
            </authentication-action>
            <authentication-action>
              <id>mfa-email</id>
              <multi-factor-condition xmlns="https://curity.se/ns/ext-conf/multi-factor-condition">
                <attribute-enable-condition>
                  <second-factor>
                    <id>email</id>
                  </second-factor>
                  <attribute-name>emailRequired</attribute-name>
                  <attribute-source>action-attributes</attribute-source>
                </attribute-enable-condition>
              </multi-factor-condition>
            </authentication-action>
            <authentication-action>
              <id>mfa-sequence</id>
              <sequence xmlns="https://curity.se/ns/ext-conf/sequence">
                <action>mfa-email</action>
                <action>mfa-totp</action>
              </sequence>
            </authentication-action>
            <authentication-action>
              <id>mfa-totp</id>
              <multi-factor-condition xmlns="https://curity.se/ns/ext-conf/multi-factor-condition">
                <attribute-enable-condition>
                  <second-factor>
                    <id>totp</id>
                  </second-factor>
                  <attribute-name>totpRequired</attribute-name>
                  <attribute-source>action-attributes</attribute-source>
                </attribute-enable-condition>
              </multi-factor-condition>
            </authentication-action>
          </authentication-actions>
          <authenticators>
            <authenticator>
              <id>email</id>
              <email>
                <account-manager>default-account-manager</account-manager>
              </email>
            </authenticator>
            <authenticator>
              <id>htmlform</id>
              <authentication-actions>
                <login>country-sequence</login>
                <login>country-script</login>
                <login>mfa-sequence</login>
                <login>debug</login>
              </authentication-actions>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
            <authenticator>
              <id>totp</id>
              <required-authenticator-for-registration>htmlform</required-authenticator-for-registration>
              <totp xmlns="https://curity.se/ns/ext-conf/totp">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
                <bucket>
                  <data-source>default-datasource</data-source>
                </bucket>
                <delay-window>1</delay-window>
                <generated-key-config>
                  <bucket>
                    <data-source>default-datasource</data-source>
                  </bucket>
                </generated-key-config>
              </totp>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>demo-client</id>
                <secret>$5$pIgEyBRhdvrlOrhj$sp6bj8MyBT6qG2hkKQmOLs1qUMUqVlw39HTiK5zIhi0</secret>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <scope>openid</scope>
                <user-authentication>
                  <allowed-authenticators>htmlform</allowed-authenticators>
                </user-authentication>
                <allowed-origins>https://oauth.tools</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT accounts.username, accounts.attributes->>'countrycode' as countrycode FROM accounts WHERE accounts.username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.SFU4bTJKNnA1UTBWUHd3RQ==.Sp6jnFPzU7njgEmGWB9wwg==.FD33bJapZ2Q4uNQ1jFsXHjBb0egArbkE2avprdlKC0_DeTVFtJM9ZXP0HcmPei66.SInQiHQ1hTXLUbstyWE8i-W8OYbRCUFNmCVFomi6RUA=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.Q2kxQ3F4MnJXOU5tcERzaQ==.vRqQULnoiTkYdJjPHnxR2A==.bHUaZW9nrSAx1VkurGGZGA==.XxQGtnKidyvUphocc0Ft4WGrOjra0bOeEfsAuJ6v7fE=</password>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <email-providers>
      <email-provider>
        <id>smtp</id>
        <smtp>
          <smtp-host>smtp.provider.com</smtp-host>
          <default-sender>noreply</default-sender>
          <username>noreply@company.com</username>
          <password>Password1</password>
        </smtp>
      </email-provider>
    </email-providers>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.UmVPMEs3UUdDNTJPS3E2RA==.1IThQBnpkRXq97rvVIJd3w==.-0jY-233f61KhbpoHD_z83dx0sB7KKJyr1-Sxu5dwDfPxN0vXZvdKJ4yoB1yTyORpX9Btv6dcC6KGyzE3ud8y4SgBAcRTMbMBnYpqegXepWmsWzYu4KBenoNPQ-fxTfqncQiWp2POA3ep7k8yoOQ_Tac1DyifuMlA2icU8rBVurKxnQ9ffH8SuwfnvL6r6npFLOuvTvMMPm2tYsqA6x3dqdbEPaF36cwVaCWhhWp4uPm4GMSWRAXLJwyPUuG2GJlvGSXObt1qDkYrUxsPYm_HpGy11NDz3wU3R2lw-L55Yo798M8cH3L_DFnFnNzXxXIfWMEsubmk4OosAixtkIQUUV9sSL4qHMBtmffs2PIhlDCUe3uGtqJWyjXKvJw5wdBgX6HpY8PQLk-uC5GpC6P0f3ySLd8OTg9nWvoPtjAUXfs_f0nhlLTp9ZF8tq-k99ghaFZwjC5S4oTDs3c5cZE6_fEyCHWqS9uySArs5xozj2OddCqHPahv0g9dDYLDy-vXInYGqZXaOXblQZ8vS98d3cC18FMCCMNUuaFlfAXDkOZpAJx-RRrN5-KkLoq1GPwpBafG2_jCtZ8yJn5Vy9CG_rKxYmlm_2fzuLsoUCHoq9-M9KuA9Rm6KHZ5u8tgXuo7YqtM1oguR3Z2Iz_GLLS2EoZClKKNen9lEMijbquLd1FuLYUkLQnKG2mJ2iD5C9Xpp9Be_0_PZMaik_9coMgMCVtMfKfxVXyji4CzRlAyYFqEwNeJF4rDmWLmDoGdSufxztFUjjV66dU8dm1Fn-EdNe0XeTO69XrYF-SAsKBk9p7uarho3lmELAwkIG7TY9YoV8DgEBtaoY4yKGF1LgdJfhRdmIgizXJ7A2SLHVk34WeBaG11Yxw25Eg7s3pNt9rSVs07kQNDJVq1UTjp52Gk-kutNcmtZbTGGQSUnHCD0wRg5mgQP0x_T1PaVJhB8Fn2kJ8XwhTj-2zcgi-L3eLx63zX0o80XvQTcEshBLFgoipH1ZfC5JH_fy7nhKMIQkLM-ZduCLJUk5ahhEZTfDicgXPjcgdYYVR5D9lQ14ZgXlW71atI6PhazoTw2xc-QdXFhWCnmHAdUxLmu-Eur44_osKSZh9jR1ZnVcZML8BPVESOBHuSDywAagv_AHmyq3aA0Ws1w46V-ad68FfF9Maz1RutmLCmsY-PL7yM73ciDNZ4EkSwKfO_1ITQr7JzLpOu4S5GC025G6y3aU0QF4rzhO-hzlVcF5aZS0idPLxBq8jJ1ZBAbItLDr1zzQbF-FGBOe0gnP6jdLriNTFuN-Ag9cExVvQ39Q6mFAsJmuujm7YHX8uZdS1pyjUo43M6MPLJMa5XQyRPRLcj0WRwz6Z5XZxZ_Gj5KFIhJ0lgVYAoREPA4yIOBXm41uNQn1fkrfpGT_iarF7M7xqQy3BA8cA8c0BPivEnMKXfCez3BYiXrh45DOS2W_Qh3Cdfcuv4qLbWjWIhjNfsGcWVMUyz3PeCXcqsGlpTnBWCoT67qEo4olzTdLPWwGZjkbeFUbY8zAtp_ZUOvtBDUbyw7M43yRfIWLhyRhxb-pgTSCBop1Bs53MV_KJzH7ktY_-vQ111ap55momFH47hJqemdjK10iWdj08gSqKbxV0w8Y2rQG2mY4M4iT8RQhLDj54QFyVV4pxj28lcdbUe44e48OLrDIwwtT-KtzhuXVSNXfzdS-eThrmPpaVlkO2a3mAhdXpW_vcf2HvNQY5iQuQJKCBeAOdksUEGPErvANcIG6wAdBtxqrKRCPYV-vsxlmOFM2O-BLbqOrtzb4xvn5xQmGtnndiQCF1rgXNG7naFEtH49KDh10eIZLfnNBsLQYb7kdHewftqX6a1-DNkEQZDGoIHp8bHOSxEMOFCn9fcFgIQJ3w7MAXQCVmQveORdjTK8EFbcY8dU35_CVTjTDo_-BHstZgZgVR22CBrFeQcWxXVYjJWLeiQ2xcOyI2EXFWT7MCtBoRpXruzVig69bBJw7zpsnj3n88xQ6-b2-CXVVXdJWBhVSjk71CpFXTUsNIvYxKRnRMIR6HnSkzHFlQ7wQWg52qc9sshnCepSbwbqmssMCGCXuY-WLlRWeRQIMnmWMhM2QcUrH-ItFNq1-ykOfWdrP-tc-VAr1X53ppH4TmIWtLO9nASSWvn8MkMfwAw_qIklvIX8JBAysx9nRpT5NpIqgyjmJAeFKYDbiEItzERrs_VBMr59SeOJ6hwMzq1LmbwQmDwyjGchzaZlzmJC5NNNmAYxBu48UVQlCpNb0g1dRJhkyQpR3kF0HvE3ONNeGugK-Yko9A3FCYIQnhpnExmhPj23o6asbuwpTOOtCf99lrRU9lXZOtphGP5TeyTE3wXmWTIsJ7vNzyK77NW8YIS2Kv4VLoyBZgAHIjpLxZ_AVhO5PchQuhVMikXrDPwi-Z0pKh6yavYWILtivekAwFwPSD8n1K6QDXXxzdGKoHU2QJjywq-qgb0Lku5J8B9czC1Un-8sMZJtQK3Hfb0vai-f_0nk7fPt48kqhPI0VfB2amU6LpBTVwHTdvRX2pnKAUplcAJMYrx1QcTYWWdhrWjJ3IhL9jenEQQ9b5kkylz4VWXWFRQsfntlNX9CuofZDjeiAGajT9hK1qu5zTVbV38rGjXj35R8cxImDiD-QETwCPTJ2pHqjryn9_2_2s0PgF__Y12h8JiEMCQKmGDFe-9mU4K4LCwD3WWLZcLZdL0ydZeJLZwnf146oxjrewPP6Mqfh_Tj0p7M8-9EPmm2BdKjGW6xHml-fDpjY75AwLeM8NNtbytfK6WpkAiFqb9Nbh4DSPOcFzJVUfbAUwgxgX3LhMphdeW4roGS12Gfvn13Hw2J-ede6E7aHb_8hPc--uD7tfeQibp2N2h4qrFbWRohR3sSd7bn5dZEFAK39LYxmVlnx89XIupJC4Ie8APfAYuxHG6Nbhn8QZTxrKl5uQNCEaY2Sro4nzhohfUc3Ee6H4Y-4eXlRcqbRhoZTg9iTfWYvtJxatZbCHMjG8_8B5aGI4nU_3w28Mm5RLd0T0YOdrhtXiOIHcCx3xa0vlevkTC6etWr61fIEiboe68O_c-E-XxylWl4_ZZUezNPybzIsAPDyVrWVjNO0i2rDNwq_g5AgVnyrWDvegJVKxFdx0NqMIDdFV97mp3Clg2MVv_8FLXMDjYyyt1HnuFwG3nbkgZf1SXWXdp6AljoxD9wkktb1o_5BUzElLfHJX34D5CPkjYXssECaiT443AjOFIA88sMIpilno34N8AJV1qMjYMoTH0w0vI1mzsBGEG3WJBJvzZdo5J_HYkwOP_fIzKgjBcv7J4lCAQ6rOBjQ7mDTKjp8VrxrKsil_THh8HaB71zE6U9TAJJODI5ZODAY-R1dCBRl1pt0FBV9xM3fPjf9-hYNGWsHR2kP8zCgevS0CXHx3ScTpx9m_ZYYgFsmYLbtOkdfc5L-h1bzHCF9SBTDDMmI7MHB4Mx9EWLdr8E79xXrGqkjDcVsJOGp2iU6YG3wqerqwx2oHoT-17n-mqanIDozbo_YzGL1AyyV6MZK1ksNDFedJ8qsq94t_eY7FsqBabCgDF3F3I7Y6OcFv3rdaSPJHhoWz4P_NXkNwxmVLlbcygWkPDm5F5LaDFbkGJyMNKMeE.9b8kSZruORrzZLpa8G7_L7PDod07RsrtRGtWMSEn8ns=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.MG9YME5sU1NoQnllTHRTbw==.80PZky0fdJkgW4cVKobRrg==.hmEc6Y_FJL57p1k2dmfh2LpKUm5neAtljZxelZRC4XtXdHeAf20xxjUkPWxtrw-axRE5KlZfdxKMwSrvGC1tkP2oGE9pP0zur9qSdJEdbqwd7N305fEr494e5Jpk83KxJ5vXxHNd0SolYE2TyRJPa3RCqX9YAaOvzrz7zqeI6VwyeSPPsz3Us33X3JQ9VzlWu1j0SNaX1455V7Pmg-Lhxu8TC4LonaEAs4iRyxeJ4CePuvIGfD3225NywWFYnhyR6qFOLLpctNOzB6hce6fJaTn4f_TE2ktx5EzxEKlEd4sYzYpduwYjGyJekBTe1vynMVCow6Q5VJ0v1X4JdFH_bd-9yeBYtVtQ0U_zPTj3LAJAmpy_Cjcd4vZKYY3AVRUwhgLfC58ggtnGVy0T4fRP0NcnFGXnPnIGrQ9-6YslcWUX8sfbhGVS1BqVDlVUnkvfz2fdi6wP9_c5Pp6Dz9foDZY19syRH0hS5iIXm6mcxSKUSiz1mjg5ocXZW42FJA6hW9TzQOvABvClJ_BVMpDDbkT_bpmicaznzWlC1CftMoQajn_fBBFmjmZR9jyvf71TZqLCjRMq2C3o8-cNow7HGQQ8idl1RWuArX0cpOZdGzgLyMe4ix2dqYUgnmhHzsqI5E5YTOl7eKFFssKIHhUNiESznybioKc7JoIspxfAEEVN78xMAR4Ppp6N-bs-ip8NqNJk6fRg6UjVUG5dY2N2VDX_l4fJZlPxsA1MIZgAItWSl9BoU7R4WEq1je0rnRcy-5pczcno5xcjYHkFNgfxtnfFFOzqbmaDhqieGOGxCiaX41TriMmPhQ3HwDy8HTtaDF5Dk3SXt8WdR4xq2qLnOmToiRyrvJ_Fd2vbBTJOaaPfzH3n3CoWAl6VBsUPfZSldBw_uDtQgYxNVg7B2NWZVD3P9B8vJXNhmp5R9auLFmgmwHwlveBUT9tda-MhiUFK8jMxBkTH355GAEy4_bQHW5a1CJgDTwSARFGNPL1iBJsZnZPtG-xbwil-NUj1QvldT1_PdKneFbA9vuCNtiyMLw2402_5U8FYgzZzry72Osrsieu0CICLEQRxh6VHfziXAxUbddeTa4gIy1cXCPJVYY8jOePNo3p7od86rcv6_myNYnaVOfXks9oVDjBhdjfSI10SeV2ljd2stoIWTRcbDGHBx0a3RTm2ViNBdWAgzSm--55SGpuuEc3VlGqMezeLQMmcdvZIwo7PX0MLEs7E5DRR7Eurl6TbDOeVCgg3iA0QFaDgol_RS_jcDmsm1xzn7WyFuiTO7tmNhC2y0h0r53oj7jk6gv4SPdpdcCTzNn5t835DHE-7K4RUhzMWgmEbZ8mauso44TX7Hnwqqaba3egR0z5TGpGQJSw_yZyLECmqS_Mc1xEiMkrzRs1X6zVsovtUlYDsMyoIfA0gUzfNdkj-tbzQHBqtjT7CLovX1OsO-Aj3oxsLy9C_947HXxed6yXYYnuE9SENvqRohF1OgSNsaZTYp8sBlv_l0LIemc_1p5vYQIxVw-zmEhichFDsIlUfN7Ln2RWDvoQu6XV0zitnqRwsWgXNNEjhW2WAwvO4hGk8mQsx3U89xM7n51HYUDYfnSJ6n1TP9aRVr-6U59HOprCxRAfUeVeLdc8028fxH_2x-JR2KVOzLil1Gn-zGU3Fn-1jJ2qRwR6AuSKROuCPoUdh9JAHjPHX1e8fUnDXA-S3QuDU6X9UpG8TGOywiOWcYtW0iBler52YOluG4Sczb4eQ-152-8K8R7RZlknxIO2GgZ0YGcnBBrf2_w3bju_V_2S2QBah3XZeb9YgNMGjw90cpG16nZKOF9IVrZLW4CKpeUzWiOaFcKPWek1U35Xqj6MRKmG-o54o3pLU44o2aZiRZvxG1f_EgHeTwbFivQGkoNS6kcbm292R-I3QZ1ujznBP_lWBKL8LFRrio_MbOKwOmg65srUoqbSGYljRvQBJVMxcjDAn1araFdoJlk8HXsKs5eMRx6ShZoxPU3kqnMlKA285Z6O3CucwtllJmvGmUDNz0AjM5hMInSNxAyGbvDUJmWpTobIMde7iJHzaUdxKQ2Z_3ZQiGiiUjl_Ug3MYNW9O5KAumpHCdcjknMmJhUXxEYZcki1TsjcI9jeg6Nne1lh7f8My9LyMr2qxy5MStdzkeRFU-bnexd6AhV93EjIOoS1GOmpSvGNy37Xv3Q0SEf7NBUK_36Sj-qsdl6XAhU_oy2iI-8MUQrJ4y69Q9WzW2Dw6w0UHmfPGr9_TgWw8Bf3brtYgtJ6X8peDVq_ZlaAxxvWF9h_LKhOHZM_8g37lOXV3OBRtGgNib0_WwexnWlUvgzeLS7_IZ_lDXvYnYHOqLKP4MkTpYgEyFTGRpwvfIYhWdnpjlCHsCl0AIVQsSAeEwSYl6SzsF4qjNtsb3lFUIsdwLMji8PLqQkfi05V5CiuHhulsrsFt2lDRokxhXowLNIWDhshs0829CWGr2_prsyFO09t5rhgdzuLLAdoXhTmvNtMVtkm5sr2Sx0d9sB8kMhMoA9rPh72Ph19ImBFvldYD4p2WERFoZ_RNpksBrKcqfdxnI5SQoLa2-8T2SGgzhuFQIOmyj82skYXk4pvWaRelgvCqmE7zoKhE7RCu6wP8WT5-4YbeU42x12iqjTAX32lIBXaL94xMUU-7nz3FX_r9oTjXG9EzESpmKjUBL9HzB777PWQUv6wH2MUtUSKme08fZgDvHVTxrEdcP-9xUdGRDp_QcCVoNytg4nLp2D-o9H1c6M_9bNy99gcULEjwy_xaaJoOBRsJKGDe2_Q3vcc7asFjH9ZWOt0ZD2FU6oFnicCt7JYBrG2_RfUSmH5munp4C5zfyzEOFECC0VAjUJVMHGNHc6d6puJOF9GIIKKGK5C_PD4UbRi24JUBcgoruwL0TBljwuBCWKyBW9JiVLQI2bqjtDncgUGja2MNd-JToPuiIuGv05Xk9Oci2SusUyr6yg-5l6sr1mE23bU_sk_x8MXLSZjdl4fBwzwQoQYZv8L8-1X6VuGjsoJj7l6IeGs7d-nY12Izmiji_SEKc9pj-z8p3PLJgEZ8fwMU4EhX-NN5CHfHB1r0Se1E_Fb4kJIX0DczZQPjtVJYrwByTXbDYH-os68z_jprQG4ZtlZjQ9MS1dbBNWOYB75wY1xx1LxCiS33mIRh-tY7TvjDiL_eKc10VaV8FpNHDq2MJsN00a7km31UZOtyXO25DwuHdgCeMxZlSkE9TxTtGKg39LsbzUdxIxYp_2cHNoJrS08HJPULPnzK9L2aPgGKH5Ct3EVC2CRqD5HhYM6adIoUpSXH4u6q-GYWKkvVE2X2PIJroAztOP4jBkXYDVtNWbpi4aN_oq00Idi8EykGADOcz5Dhves9rB5zeVIJpLewGSqAXyIYfAL7l_Fyxdxo129k35dIY4jVTFoymPNE2zK_E1n3qQNrDDzihW6xJm90B4rXy5MJDFHVYiJJsFEIP7dBSlSPnmWwfdfSl5_FutP24ybYLjQDv6l_83qZaknrMsJqonniqQnxZRGzQNUp4j2bFVYh5gceevxzZo2wsN8zAqP___Y-KjvE7UmVYRuc17zkQpcFqsiQvXk2gtH6myGo0rpy16iEc9tKybchG_hvw1Olo6QBgIfl.Kh6xzspt-COW0K72yjmTlVxW7_thnHHyJQ-DwvN-lPA=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.aWM5M0Y0VkZGNUg0VTFqeg==.7QLb6aU7JEKXLv13IBs3Mg==.lckyivL65xKq6uZFInQolZxlS1XmlspPo6AYl8R6P0sLZJjYIyBHo_U7x-4e23Zj5e28IUJSzl4G3JPAbjxcS9gVucrM9id4D0qOLcSEJIibnLw8pAESXFjs8ZRN5qiTOJ41c5yLocp6Gn3AhSZBJdBjPSlKRi7zqSO7Hr4yX86qSZgimko236ECGnewAbMTPdFCH0p6J-1Sf1ewkvI4AXSx-E4FQiOhJOfHpe80u-kLgIFnwFGQw8lvVGLeBglzbtY02-mEnMLMdmqjvrQxWvcaL5i8wiMYb299vokOP3rj02R4D9O1iBD5Alz19LPUudndRD_5-yc8w6UNkDSS8iLnHOSveEVHRihy8r7bNSTZnfAiW6wZjF8vdlF50xqEoMvuttto8DVf0WVzK4hZvHOugR-4RHXQ-8m6ZKljhgNM9wV6IULPtzu67MOcbqyDehJ-8giUELvBm2BqZYnccVAEVLeEy-htrugv_f2XzGYf9rcvpf-J5JeYRF8LRc6PNtuCh-jhvaq2ygOvfAu3U6PeVChAJPu-WxtkrWcDQB-Q5An6W35iT2vSfqM5h827lDAjZUnpAYLYLe0nmNSd6JHUNHMk5IEnCgIU8VNvNRqdzPsr53kabKOua9hAET5F_XN9eGoRMh-ZeMNqbsMzb1UxEE0rr-o_ZaQzyGX75lYC4ZGGOELkq-PwwaSPphtaAeuWoeuySWODUSCVZHdcyqTFwxGs20DM0G-GhOWdaXZnRUEZoD3PZ1HAy1LJve9t4PycjjfYKKsyBc7JrFVYzBIomzl03ymYglMdcwqs5Hn53CyAmpDBFsMo-Rygu4ghZUSxgylkDzjWRU63lv1cAYNPuksQ4lyc0afj3GtgiCVsNtOd4kcxI2r805sUcQRGBK4moSAr6ISVZh5q6XF2rr0JWTh2s1E0RIaaNVp06RKXF7zx0w7Qw1NCZ5wf3E25CR5SXFLvsXtBGTs--G1nvBTsstfyeb604lmyzjB_LPG34DAnse-wPJSGM8LvjVFqzSTKmWOb4tw8c-6OtEAJqUO6rDw-YXfgVN_VsIPRlis5GDfyVM49LAUTsmg-1J5F5uI_i1Roegf31nHanWjp_PNoi5I-IXF_LK26KGmbZ_lk2KfeEFsC1lCDaE-598GMQIBWH2q7ngciwstYDvSNTi1DuyPb_PmnMm0HyC5z6V3N7cmiAtc-RDVXpaFSshlWsoJffStL5W49K5D6i349rfWwwGfjP485no0LSSdXQm_7_NrkeNpjrp-J4ihRfnncL3VHI_S9IWrsB2VKJ_EJC44Ncknp3MpnMZJKTAj8UZg8o7-mWKDOBUM48rDafhgopd0EwEG9rQJzFBGT7T4C1jiM0iVTGcnc5QUF59xYsAYelyzE0RJxmvymMOGCF_oAax2dCXtXktWzarqVXsdMx6B3YpJLynbV9YL2UMOc1ltPsf7gzPW9Q-91V98kh955j6SYrud11Fvlu7ITABkQ_pPXqRII3FeAsHqKiKYmDw8LXembUu8vQZoxZsjtsFpsnUV3u7ruKWLTC0pRJXYjyOyz5hsJOsJ7tvAz4S6gUFaI2xU9398-1JXBWqz-x8yqYN0Q1cioTIgUTU2J_CdZrgYTJhoPYfbGBekrCog4WkiqBvkZomb8CB8IwZBspu6dYkG127S0jxktxrWxhDSxxA==.E327wZSOWG-kgj5ssvcYHIq_oK7iphWw02D-QpNobPk=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <procedures>
      <transformation-procedure>
        <id>country-proc</id>
        <script>LyoqCiAqIFRoaXMgaXMgYW4gZXhhbXBsZSBwcm9jZWR1cmUgdGhhdCBwZXJmb3JtcyBubyB0cmFuc2Zvcm1hdGlvbgogKiBAcGFyYW0ge3NlLmN1cml0eS5pZGVudGl0eXNlcnZlci5wcm9jZWR1cmVzLmNvbnRleHQuVHJhbnNmb3JtYXRpb25Qcm9jZWR1cmVDb250ZXh0fSBjb250ZXh0CiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICB2YXIgYXR0cmlidXRlcyA9IGNvbnRleHQuYXR0cmlidXRlTWFwOwoKICBpZiAoYXR0cmlidXRlcy5jb3VudHJ5Y29kZSA9PT0gJ0NOJyB8fCBhdHRyaWJ1dGVzLmNvdW50cnljb2RlID09PSAnSU4nKSB7CiAgICBhdHRyaWJ1dGVzLnRvdHBSZXF1aXJlZCA9IHRydWU7ICAgIAogIH0gZWxzZSB7CiAgICBhdHRyaWJ1dGVzLmVtYWlsUmVxdWlyZWQgPSB0cnVlOwogIH0KCiAgcmV0dXJuIGF0dHJpYnV0ZXM7Cn0=</script>
      </transformation-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <username-is-email>false</username-is-email>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$2qkQhDKp$DC4HBsqaRcxMLDnwkZi2h4hZALHZDI/3G5/zXEl9E05</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>